window.__require=function t(e,o,i){function n(s,r){if(!o[s]){if(!e[s]){var a=s.split("/");if(a=a[a.length-1],!e[a]){var h="function"==typeof __require&&__require;if(!r&&h)return h(a,!0);if(c)return c(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var d=o[s]={exports:{}};e[s][0].call(d.exports,function(t){return n(e[s][1][t]||t)},d,d.exports,t,e,o,i)}return o[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<i.length;s++)n(i[s]);return n}({background:[function(t,e){"use strict";cc._RF.push(e,"515f5VvvkdENIUqN0Twk+37","background"),cc.Class({extends:cc.Component,properties:{bg1:cc.Node,bg2:cc.Node},setEnabled:function(){this.enabled=!0},setDisabled:function(){this.enabled=!1,this.node.stopAllActions()},onLoad:function(){this.triggerY=-this.bg1.height,this.enabled=!1,this.speed=100},start:function(){},update:function(t){this.bg1.y-=t*this.speed,this.bg2.y-=t*this.speed,this.bg1.y<=this.triggerY?this.bg1.y=this.bg2.y+this.bg1.height:this.bg2.y<=this.triggerY&&(this.bg2.y=this.bg1.y+this.bg1.height)}}),cc._RF.pop()},{}],board:[function(t,e){"use strict";cc._RF.push(e,"0f844G6mTVJebXtm2ORwxQE","board"),cc.Class({extends:cc.Component,properties:{gridFrame:cc.Node,tokens:cc.SpriteFrame,meteorPreFab:cc.Prefab,hoverClip:{default:null,type:cc.AudioClip},clickClip:{default:null,type:cc.AudioClip}},isGridActived:function(t,e){return this.gridBox[t][e].params.isActived},gridMouseEnterStyle:function(t,e){var o=this.gridBox[t][e].getComponent(cc.Graphics);o.clear(),o.fillColor=new cc.Color(255,255,255,100),o.fillRect(0,0,this.gridSize,this.gridSize),o.enabled=!0},gridMouseLeaveStyle:function(t,e){var o=this.gridBox[t][e].getComponent(cc.Graphics);o.clear(),o.enabled=!1},spawnGrid:function(t,e){var o=new cc.Node("Grid_"+t+"_"+e);return o.addComponent(cc.Graphics).enabled=!1,o.addComponent(cc.Sprite).enabled=!1,o.params={meteor:null,isActived:!1,status:null},o.x=e*this.gridSize,o.y=t*this.gridSize,o.width=o.height=this.gridSize,o.parent=this.gridFrame,o},spawnBoard:function(){var t=this.gridFrame.addComponent(cc.Graphics);t.lineWidth=2,t.strokeColor=cc.Color.WHITE,t.strokeColor.a=100,t.fillColor=new cc.Color(0,0,0,0),t.fillRect(0,0,this.gridFrame.width,this.gridFrame.height),t.stroke();for(var e=10*this.gridSize,o=0;o<10;o++){if(o>0){var i=this.gridSize*o;t.moveTo(0,i),t.lineTo(e,i),t.stroke(),t.moveTo(i,0),t.lineTo(i,e),t.stroke()}for(var n=[],c=0;c<10;c++)n[c]=this.spawnGrid(o,c);this.gridBox[o]=n}},spawnMeteor:function(t){var e=this,o=cc.instantiate(this.meteorPreFab),i=o.getComponent("meteor");i.spawnMeteor(t),function t(){i.getLocation(),i.location.some(function(t){var o=t[0],i=t[1];return e.gridBox[o][i].params.meteor})&&t()}(),i.setPosition(i.origin.col*this.gridSize,i.origin.row*this.gridSize),i.location.forEach(function(t){var o=t[0],n=t[1];e.gridBox[o][n].params.meteor=i}),this.node.addChild(o),this.meteorBox.push(o)},startHandler:function(){this.spawnBoard(),this.spawnMeteor("A"),this.spawnMeteor("B"),this.spawnMeteor("C"),this.spawnMeteor("D"),this.spawnMeteor("E"),cc.sys.isMobile?(this.node.on(cc.Node.EventType.TOUCH_START,this.touchStartHandler,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveHandler,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEndHandler,this)):(this.node.on(cc.Node.EventType.MOUSE_MOVE,this.mouseMoveHandler,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.mouseLeaveHandler,this),this.node.on(cc.Node.EventType.MOUSE_DOWN,this.mouseDownHandler,this))},overHandler:function(){this.meteorBox.forEach(function(t){return t.active=!0}),cc.sys.isMobile?(this.node.off(cc.Node.EventType.TOUCH_START,this.touchStartHandler,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.touchMoveHandler,this),this.node.off(cc.Node.EventType.TOUCH_END,this.touchEndHandler,this)):(this.node.off(cc.Node.EventType.MOUSE_MOVE,this.mouseMoveHandler,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.mouseLeaveHandler,this),this.node.off(cc.Node.EventType.MOUSE_DOWN,this.mouseDownHandler,this))},checkIsOver:function(){return this.meteorBox.every(function(t){return t.getComponent("meteor").isShootDown})},getCurrentLocation:function(t,e){var o=[Math.min(9,parseInt((t-this._startY)/this.gridSize)),Math.min(9,parseInt((e-this._startX)/this.gridSize))],i=o[0],n=o[1];switch(this.getActiveBomb()){case 1:return[[i,n]];case 2:return[[i+1,n-1],[i+1,n+1],[i,n],[i-1,n-1],[i-1,n+1]].filter(function(t){var e=t[0],o=t[1];return e<=9&&o<=9&&e>=0&&o>=0});case 3:return[[i+1,n-1],[i+1,n],[i+1,n+1],[i,n-1],[i,n],[i,n+1],[i-1,n-1],[i-1,n],[i-1,n+1]].filter(function(t){var e=t[0],o=t[1];return e<=9&&o<=9&&e>=0&&o>=0})}},touchStartHandler:function(t){var e=this,o=t.getLocation(),i=o.x,n=o.y,c=this.getCurrentLocation(n,i);return c.forEach(function(t){var o=t[0],i=t[1];e.isGridActived(o,i)||e.gridMouseEnterStyle(o,i)}),this._prevLocations=c,!1},touchMoveHandler:function(t){var e=t.getLocation(),o=e.x,i=e.y-this._startY,n=o-this._startX;return i>this.node.height||i<0||n>this.node.width||n<0?(this.mouseLeaveHandler(t),!1):(this.mouseMoveHandler(t),!1)},touchEndHandler:function(t){return this.mouseDownHandler(t),!1},mouseMoveHandler:function(t){var e=this,o=t.getLocation(),i=o.x,n=o.y,c=this.getCurrentLocation(n,i),s=this._prevLocations.map(function(t){return t[0]+"_"+t[1]});if(c.map(function(t){return t[0]+"_"+t[1]}).filter(function(t){return-1===s.indexOf(t)}).length>0){this._prevLocations.forEach(function(t){var o=t[0],i=t[1];return e.gridMouseLeaveStyle(o,i)}),this._prevLocations=c;var r=c.filter(function(t){var o=t[0],i=t[1];return!e.isGridActived(o,i)});r.length>0&&(r.forEach(function(t){var o=t[0],i=t[1];return e.gridMouseEnterStyle(o,i)}),cc.audioEngine.play(this.hoverClip,!1,1))}return!1},mouseLeaveHandler:function(){var t=this;this._prevLocations.forEach(function(e){var o=e[0],i=e[1];t.isGridActived(o,i)||t.gridMouseLeaveStyle(o,i)})},mouseDownHandler:function(t){var e=this,o=t.getLocation(),i=o.x,n=o.y,c=this.getCurrentLocation(n,i);return!c.every(function(t){var o=t[0],i=t[1];return e.isGridActived(o,i)})&&(c.forEach(function(t){var o=t[0],i=t[1];e.gridMouseLeaveStyle(o,i);var n=e.gridBox[o][i],c=n.params.meteor,s=null!==c,r=n.getComponent(cc.Sprite);r.node.anchorX=r.node.anchorY=0,r.sizeMode=0,r.spriteFrame=s?e.hitSpriteFrame:e.missSpriteFrame,r.enabled=!0,n.params.isActived=!0,n.params.status=s?"hit":"miss",s&&!c.location.some(function(t){var o=t[0],i=t[1];return!e.gridBox[o][i].params.isActived})&&(c.setShootDown(),e.meteorBox.forEach(function(t){t.getComponent("meteor").isShootDown&&(t.active=!0)}))}),cc.audioEngine.play(this.clickClip,!1,.3),this.checkIsOver()&&this.changeGameStatusHandler("win"),this.minusBombCountHandler(),!1)},setMinusBombCountHandler:function(t){this.minusBombCountHandler=t},setGetActiveBombHandler:function(t){this.getActiveBomb=t},setGameStatusHandler:function(t){this.changeGameStatusHandler=t},onLoad:function(){this.gridSize=50,this.node.width=this.node.height=500,this.gridBox=new Array(10).fill(new Array(10).fill(null)),this.meteorBox=[],this.gridFrame.zIndex=2,this.meteorPreFab.zIndex=1,this._startX=70,this._startY=230,this._prevLocations=[],this._isLegalPosition=!1,this.getActiveBomb=function(){return-1},this.minusBombCountHandler=function(){return!1},this.changeGameStatusHandler=function(){return null},this.missSpriteFrame=this.tokens.clone(),this.missSpriteFrame.setRect(new cc.rect(32,0,32,32)),this.hitSpriteFrame=this.tokens.clone(),this.hitSpriteFrame.setRect(new cc.rect(64,0,32,32))},start:function(){},onDestroy:function(){cc.sys.isMobile?(this.node.off(cc.Node.EventType.TOUCH_START,this.touchStartHandler,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.touchMoveHandler,this),this.node.off(cc.Node.EventType.TOUCH_END,this.touchEndHandler,this)):(this.node.off(cc.Node.EventType.MOUSE_MOVE,this.mouseMoveHandler,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.mouseLeaveHandler,this),this.node.off(cc.Node.EventType.MOUSE_DOWN,this.mouseDownHandler,this))}}),cc._RF.pop()},{}],"button-audio-effect":[function(t,e){"use strict";cc._RF.push(e,"e696c1SA4VOE6ASgdl4pXxT","button-audio-effect"),cc.Class({extends:cc.Button,properties:{clip:{default:null,type:cc.AudioClip}},_onTouchEnded:function(t){this.interactable&&this.enabledInHierarchy&&(this._pressed&&(cc.audioEngine.play(this.clip,!1,1),cc.Component.EventHandler.emitEvents(this.clickEvents,t),this.node.emit("click",this)),this._pressed=!1,this._updateState(),t.stopPropagation())}}),cc._RF.pop()},{}],cover:[function(t,e){"use strict";cc._RF.push(e,"a84d04BSwRFJac3grNhGy1A","cover"),cc.Class({extends:cc.Component,stopBubbling:function(t){return t.stopPropagation(),!1},onLoad:function(){this.node.on(cc.Node.EventType.MOUSE_MOVE,this.stopBubbling,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.stopBubbling,this),this.node.on(cc.Node.EventType.MOUSE_DOWN,this.stopBubbling,this),this.node.on(cc.Node.EventType.TOUCH_START,this.stopBubbling,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.stopBubbling,this),this.node.on(cc.Node.EventType.TOUCH_END,this.stopBubbling,this)},onDestroy:function(){this.node.off(cc.Node.EventType.MOUSE_MOVE,this.stopBubbling,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.stopBubbling,this),this.node.off(cc.Node.EventType.MOUSE_DOWN,this.stopBubbling,this),this.node.off(cc.Node.EventType.TOUCH_START,this.stopBubbling,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.stopBubbling,this),this.node.off(cc.Node.EventType.TOUCH_END,this.stopBubbling,this)}}),cc._RF.pop()},{}],dialog:[function(t,e){"use strict";cc._RF.push(e,"01159Mg+XdCPKsCf+EJ/R6X","dialog"),cc.Class({extends:cc.Component,properties:{content:cc.Label},resolve:function(){this.resolveCallback()},reject:function(){this.node.destroy(),this.rejectCallback()},setContent:function(t){this.content.getComponent(cc.Label).string=t},setCallback:function(t,e){void 0===t&&(t=function(){return!1}),void 0===e&&(e=function(){return!1}),this.resolveCallback=t,this.rejectCallback=e},onLoad:function(){this.resolveCallback=function(){return!1},this.rejectCallback=function(){return!1}}}),cc._RF.pop()},{}],game:[function(t,e){"use strict";cc._RF.push(e,"69029jbr/dHXZ/UkTooxQDU","game"),cc.Class({extends:cc.Component,properties:{board:cc.Node,bomb1:cc.Node,bomb2:cc.Node,bomb3:cc.Node,dialogPrefab:cc.Prefab,ruleWindow:cc.Node,bgClip:{default:null,type:cc.AudioClip},loseClip:{default:null,type:cc.AudioClip},winClip:{default:null,type:cc.AudioClip}},switchActive:function(t,e){var o=this;(e=+e)!==this.bombActive&&0!==this.bombCount[e]&&(cc.resources.load("prefab/bomb_normal",cc.Prefab,function(t,i){o.bombBox.forEach(function(t,o){if(0!==o&&o!==e){var n=t.getChildByName("bottom_flex__item__border");n.stopAllActions(),cc.tween(n).to(0,{angle:0}).start(),n.removeAllChildren(),n.addChild(cc.instantiate(i));var c=t.getChildByName("bottom_flex__item__bg").getComponent(cc.Graphics);c.clear(),c.fillColor="#0BA390",c.circle(0,-2,55),c.fill();var s=t.getChildByName("bottom_flex__item__content"),r=s.getChildByName("bomb_img");r.scale=.8,r.color=new cc.Color(136,136,136);var a=s.getChildByName("bomb_count");a.getComponent(cc.Label).fontSize=16,a.color=new cc.Color(136,136,136)}})}),cc.resources.load("prefab/bomb_active",cc.Prefab,function(t,i){o.bombBox.forEach(function(t,o){if(0!==o&&o===e){var n=t.getChildByName("bottom_flex__item__border");n.removeAllChildren(),n.addChild(cc.instantiate(i)),cc.tween(n).repeatForever(cc.tween().to(7,{angle:360})).start();var c=t.getChildByName("bottom_flex__item__bg").getComponent(cc.Graphics);c.clear(),c.fillColor="#A2F7EC",c.circle(0,0,65),c.fill();var s=t.getChildByName("bottom_flex__item__content"),r=s.getChildByName("bomb_img");r.scale=1,r.color=new cc.Color(255,255,255);var a=s.getChildByName("bomb_count");a.getComponent(cc.Label).fontSize=20,a.color=new cc.Color(255,255,255)}})}),this.bombActive=e)},minusBombCount:function(){if(this.bombCount[this.bombActive]-=1,this.upgradeBombCount(),0===this.bombCount[this.bombActive]){var t=this.bombCount.findIndex(function(t){return t>0});t>=0?this.switchActive(null,t):this.gameOver("lose")}},upgradeBombCount:function(){var t=this;this.bombBox.forEach(function(e,o){if(0!==o){var i=t.bombCount[o];e.getChildByName("bottom_flex__item__content").getChildByName("bomb_count").getComponent(cc.Label).string="x "+i}})},gameOver:function(t){if("playing"!==this.gameStatus)return!1;this.gameStatus=t,this.boardScript.overHandler();var e=cc.instantiate(this.dialogPrefab);this.node.addChild(e),"lose"===t?cc.audioEngine.play(this.loseClip,!1,1):cc.audioEngine.play(this.winClip,!1,1);var o=e.getComponent("dialog");o.setContent("you "+t+"! replay?"),o.setCallback(function(){return cc.director.loadScene("game")})},backToIntro:function(){var t=cc.instantiate(this.dialogPrefab);this.node.addChild(t);var e=t.getComponent("dialog");e.setContent("You really want to go ahead?"),e.setCallback(function(){return cc.director.loadScene("intro")})},replay:function(){var t=cc.instantiate(this.dialogPrefab);this.node.addChild(t);var e=t.getComponent("dialog");e.setContent("Replay?"),e.setCallback(function(){return cc.director.loadScene("game")})},ruleDisplay:function(){this.ruleWindow.active=!0,this.ruleWindow.getComponent(cc.Animation).play("slice-in")},ruleHidden:function(){this.ruleWindow.getComponent(cc.Animation).play("slice-out")},onLoad:function(){this.clipId=cc.audioEngine.play(this.bgClip,!0,.5),this.bombActive=0,this.bombBox=[,this.bomb1,this.bomb2,this.bomb3],this.bombCount=[,26,3,1],this.gameStatus="playing",this.boardScript=this.board.getComponent("board"),this.upgradeBombCount()},start:function(){var t=this;this.switchActive(null,1),this.boardScript.setGetActiveBombHandler(function(){return t.bombActive}),this.boardScript.setGameStatusHandler(this.gameOver.bind(this)),this.boardScript.setMinusBombCountHandler(this.minusBombCount.bind(this)),this.boardScript.startHandler()},onDestroy:function(){cc.audioEngine.stop(this.clipId)}}),cc._RF.pop()},{}],intro:[function(t,e){"use strict";cc._RF.push(e,"561a64wySdGq64V0ju3ZvtG","intro"),cc.Class({extends:cc.Component,properties:{background:cc.Node,clip:{default:null,type:cc.AudioClip}},startGame:function(){cc.director.loadScene("game")},onLoad:function(){this.clipId=cc.audioEngine.play(this.clip,!0,.5)},start:function(){this.background.getComponent("background").setEnabled()},onDestroy:function(){cc.audioEngine.stop(this.clipId)}}),cc._RF.pop()},{}],meteor:[function(t,e){"use strict";cc._RF.push(e,"ab16126wxNNq6Dep10Xpyh+","meteor"),cc.Class({extends:cc.Component,getShipMeta:function(t,e){switch(t){case"A":return{w:100,h:100,minRow:0,minCol:0,maxRow:8,maxCol:8,body:function(t,e){return[[t,e],[t+1,e],[t,e+1],[t+1,e+1]]}};case"B":switch(e){case"U":case"D":return{w:150,h:100,minRow:0,minCol:0,maxRow:8,maxCol:7,body:function(t,e){return[[t,e],[t+1,e],[t,e+1],[t+1,e+1],[t,e+2],[t+1,e+2]]}};case"L":case"R":return{w:100,h:150,minRow:0,minCol:0,maxRow:7,maxCol:8,body:function(t,e){return[[t,e],[t+1,e],[t+2,e],[t,e+1],[t+1,e+1],[t+2,e+1]]}}}case"C":return{w:100,h:100,minRow:0,minCol:0,maxRow:8,maxCol:8,body:function(t,e){return[[t,e],[t+1,e],[t,e+1],[t+1,e+1]]}};case"D":case"E":switch(e){case"U":case"D":return{w:100,h:50,minRow:0,minCol:0,maxRow:9,maxCol:8,body:function(t,e){return[[t,e],[t,e+1]]}};case"L":case"R":return{w:50,h:100,minRow:0,minCol:0,maxRow:8,maxCol:9,body:function(t,e){return[[t+1,e],[t,e]]}}}}},getDirection:function(){return["U","D","L","R"][parseInt(4*Math.random())]},getLocation:function(){var t=this.getShipMeta(this.type,this.direction),e=t.minRow,o=t.minCol,i=t.maxRow,n=t.maxCol,c=t.body,s=parseInt(Math.random()*(i-e+1))+e,r=parseInt(Math.random()*(n-o+1))+o;this.origin={row:s,col:r},this.location=c(s,r)},setPosition:function(t,e){this.node.x=t,this.node.y=e},spawnMeteor:function(t){var e=this;this.type=t,this.direction=this.getDirection();var o=this.getShipMeta(this.type,this.direction),i=o.w,n=o.h;cc.resources.load("images/Meteor_"+t+"/"+t+"_"+this.direction,cc.SpriteFrame,function(t,o){e.node.getComponent(cc.Sprite).spriteFrame=o,e.node.width=i,e.node.height=n})},setShootDown:function(){this.isShootDown=!0,this.node.color=new cc.Color(255,0,0)},onLoad:function(){this.node.opacity=200,this.node.active=!1,this.isShootDown=!1},start:function(){}}),cc._RF.pop()},{}],rule:[function(t,e){"use strict";cc._RF.push(e,"6ec1aGXiIxOzoV7X8U4a60y","rule"),cc.Class({extends:cc.Component,reset:function(){this.node.getChildByName("ScrollView").getComponent(cc.ScrollView).scrollToTop(0),this.node.active=!1}}),cc._RF.pop()},{}],use_reversed_rotateTo:[function(t,e){"use strict";cc._RF.push(e,"17b6as9b7BNpZ15wM0LAYSg","use_reversed_rotateTo"),cc.RotateTo._reverse=!0,cc._RF.pop()},{}]},{},["use_reversed_rotateTo","background","board","button-audio-effect","cover","dialog","game","intro","meteor","rule"]);